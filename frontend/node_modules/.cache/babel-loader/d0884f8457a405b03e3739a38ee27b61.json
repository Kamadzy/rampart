{"ast":null,"code":"var _jsxFileName = \"/Users/kirill/Documents/Develop/rampart/rampart/frontend/src/components/owner-operator-form/owner-operator-form.js\";\nimport React, { Component } from 'react';\nimport MaskedInput from 'react-text-mask';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport 'typeface-roboto';\nimport axios from 'axios';\nimport localforage from 'localforage';\nimport jspdf from 'jspdf';\nimport SignatureFont from '../../assets/fonts/SignatureFont';\nimport moment from 'moment';\nimport Swal from \"sweetalert2\";\nimport './styles.css';\nimport { arrayBufferToBase64 } from '../../helpers';\n\nclass OwnerOperatorForm extends Component {\n  constructor(props) {\n    super(props);\n\n    this.onChange = e => this.setState({\n      [e.target.name]: e.target.value\n    });\n\n    this.state = {\n      backgroundImages: [],\n      loading: false,\n      agreementDate: '',\n      lessorName: '',\n      lessorAddress: '',\n      lessorCity: '',\n      lessorState: '',\n      lessorZip: '',\n      truckVin: '',\n      trailerVin: '',\n      lessorGross: '90%',\n      lessorMainSignature: '',\n      mainCompanyName: 'Rampart Transportation INC',\n      mainCompanyAddress: '3029 Wolfe Ct Antelope CA 95843',\n      mainCompanyUsdot: '3411477',\n      mainCompanyEin: '83-3141615',\n      mainCompanyMc: '1100091'\n    };\n  }\n\n  async componentDidMount() {\n    window.scrollTo(0, 0); // download and cache background images\n\n    await this.setBackgroundImages();\n  }\n\n  async onSubmit() {\n    this.setState({\n      loading: true\n    });\n\n    try {\n      const doc = this.generatePdf();\n      await this.sendDocumentByEmail(doc);\n      await Swal.fire({\n        icon: 'success',\n        title: 'Registered!',\n        text: 'Thank you!'\n      });\n    } catch (e) {\n      let msg = {\n        title: 'Oops... error!',\n        text: 'Something went wrong. Try to submit again ;)'\n      };\n\n      if (e.response !== undefined && e.response.status === 422) {\n        msg = {\n          title: 'Oops... Validation failed!',\n          text: 'Please check the entered data and try again ;)'\n        };\n      }\n\n      await Swal.fire({\n        icon: 'error',\n        title: msg.title,\n        text: msg.text\n      });\n    }\n\n    this.setState({\n      loading: false\n    });\n  }\n\n  generatePdf() {\n    const {\n      backgroundImages,\n      agreementDate,\n      lessorName,\n      lessorAddress,\n      lessorCity,\n      lessorState,\n      lessorZip,\n      truckVin,\n      trailerVin,\n      lessorGross,\n      lessorMainSignature,\n      mainCompanyName,\n      mainCompanyAddress,\n      mainCompanyUsdot,\n      mainCompanyEin,\n      mainCompanyMc\n    } = this.state;\n\n    if (backgroundImages.length === 0) {\n      throw new Error('Failed to build PDF document, background images are missing.');\n    }\n\n    const doc = new jspdf();\n    doc.setFontSize(12);\n    doc.setTextColor('black');\n    doc.addImage(backgroundImages[0], 'JPEG', 0, 0, 210, 297);\n    doc.text(agreementDate, 55, 50.3);\n    doc.text(mainCompanyName, 95, 50.3);\n    doc.text(mainCompanyAddress, 33, 65.5);\n    doc.text(mainCompanyUsdot, 136.5, 65.5);\n    doc.text(mainCompanyEin, 164, 65.5);\n    doc.text(lessorName, 26, 77);\n    doc.text(lessorAddress, 30, 87.5);\n    doc.text(lessorCity, 23, 97.5);\n    doc.text(lessorState, 92, 97.5);\n    doc.text(lessorZip, 116, 97.5);\n    doc.text(truckVin, 35, 110.5);\n    doc.text(trailerVin, 37, 123.5);\n    doc.text(mainCompanyMc, 89.5, 156);\n    doc.text(mainCompanyName, 16, 286);\n    doc.addPage();\n    doc.addImage(backgroundImages[1], 'JPEG', 0, 0, 210, 297);\n    doc.text(lessorGross, 80, 56);\n    doc.text(mainCompanyName, 16, 286);\n    doc.addPage();\n    doc.addImage(backgroundImages[2], 'JPEG', 0, 0, 210, 297);\n    doc.text(agreementDate, 117, 155);\n    doc.text(mainCompanyName, 30, 217.5);\n    doc.text(lessorName, 26, 238.5);\n    doc.text(agreementDate, 168, 217.5);\n    doc.text(agreementDate, 160, 238.5);\n    doc.addFileToVFS('Meddon.ttf', SignatureFont);\n    doc.addFont('Meddon.ttf', 'Meddon', 'cursive');\n    doc.setFont('Meddon', 'cursive');\n    doc.text(lessorMainSignature, 105, 238.5);\n    doc.setFont('helvetica', 'normal');\n    doc.setFontSize(12);\n    doc.text(mainCompanyName, 16, 286);\n    doc.addPage();\n    doc.addImage(backgroundImages[3], 'JPEG', 0, 0, 210, 297);\n    doc.setFontSize(10);\n    doc.text(mainCompanyName, 97, 49);\n    doc.setFontSize(9);\n    doc.text(mainCompanyName, 28.5, 225.5);\n    doc.addPage();\n    doc.addImage(backgroundImages[4], 'JPEG', 0, 0, 210, 297);\n    doc.setFontSize(12);\n    doc.text(agreementDate, 23, 35);\n    doc.addFileToVFS('Meddon.ttf', SignatureFont);\n    doc.addFont('Meddon.ttf', 'Meddon', 'cursive');\n    doc.setFont('Meddon', 'cursive');\n    doc.text(lessorMainSignature, 85, 35);\n    doc.setFont('helvetica', 'normal');\n    doc.setFontSize(12);\n    doc.text(lessorName, 85, 61);\n    return doc;\n  }\n\n  render() {\n    return /*#__PURE__*/React.createElement(\"div\", {\n      className: \"owner-operator-form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 172,\n        columnNumber: 7\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 173,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 174,\n        columnNumber: 11\n      }\n    }, \"AGREEMENT made on\"), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 175,\n        columnNumber: 11\n      }\n    }, /*#__PURE__*/React.createElement(MaskedInput, {\n      mask: value => value ? [/[0-9]/, /\\d/, '/', /\\d/, /\\d/, '/', /\\d/, /\\d/, /\\d/, /\\d/] : [],\n      id: \"agreement-date\",\n      className: \"agreement-date\",\n      placeholder: \"Date\",\n      guide: true,\n      value: this.state.agreementDate,\n      name: \"agreementDate\",\n      disabled: this.state.loading,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 176,\n        columnNumber: 13\n      }\n    })), /*#__PURE__*/React.createElement(\"span\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 11\n      }\n    }, \"between Rampart Transportation INC hereinafter referred AND\")), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-field-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TextField, {\n      label: \"Lessor Name\",\n      id: \"lessor-name\",\n      className: \"lessor-name\",\n      value: this.state.lessorName,\n      name: \"lessorName\",\n      disabled: this.state.loading,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-field-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TextField, {\n      label: \"Address\",\n      id: \"lessor-address\",\n      className: \"lessor-address\",\n      value: this.state.lessorAddress,\n      name: \"lessorAddress\",\n      disabled: this.state.loading,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-field-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TextField, {\n      label: \"City\",\n      id: \"lessor-city\",\n      className: \"lessor-city\",\n      value: this.state.lessorCity,\n      name: \"lessorCity\",\n      disabled: this.state.loading,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(TextField, {\n      label: \"State\",\n      id: \"lessor-state\",\n      className: \"lessor-state\",\n      inputProps: {\n        maxLength: 2\n      },\n      value: this.state.lessorState,\n      name: \"lessorState\",\n      disabled: this.state.loading,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 237,\n        columnNumber: 11\n      }\n    }), /*#__PURE__*/React.createElement(TextField, {\n      label: \"Zip\",\n      id: \"lessor-zip\",\n      className: \"lessor-zip\",\n      value: this.state.lessorZip,\n      name: \"lessorZip\",\n      disabled: this.state.loading,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 249,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-field-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 259,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TextField, {\n      label: \"Truck Vin#\",\n      id: \"truck-vin\",\n      className: \"truck-vin\",\n      value: this.state.truckVin,\n      name: \"truckVin\",\n      disabled: this.state.loading,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 260,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 270,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TextField, {\n      label: \"Trailer Vin#\",\n      id: \"trailer-vin\",\n      className: \"trailer-vin\",\n      value: this.state.trailerVin,\n      name: \"trailerVin\",\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 271,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"form-field-container\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 280,\n        columnNumber: 9\n      }\n    }, /*#__PURE__*/React.createElement(TextField, {\n      label: \"Signature (Type your First and Last Name)\",\n      id: \"lessor-signature\",\n      className: \"lessor-signature\",\n      value: this.state.lessorMainSignature,\n      name: \"lessorMainSignature\",\n      disabled: this.state.loading,\n      onChange: this.onChange,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 281,\n        columnNumber: 11\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"d-flex justify-content-center mt-5\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 292,\n        columnNumber: 9\n      }\n    }, this.state.loading && /*#__PURE__*/React.createElement(CircularProgress, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 293,\n        columnNumber: 34\n      }\n    }), !this.state.loading && /*#__PURE__*/React.createElement(Button, {\n      variant: \"contained\",\n      color: \"primary\",\n      size: \"large\",\n      onClick: () => this.onSubmit(),\n      disabled: this.state.loading,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 295,\n        columnNumber: 13\n      }\n    }, \"Submit Document\")));\n  }\n\n  async setBackgroundImages() {\n    // try to get images from cache (if cache is not older then 24 hours)\n    const cache = await localforage.getItem('owner-operator-form-images');\n\n    if (cache !== null) {\n      const cachedAt = moment(cache.cachedAt);\n\n      if (cachedAt.diff(moment(), 'hours') < 24) {\n        this.setState({\n          backgroundImages: cache.images\n        });\n        return;\n      }\n    } // download all images simultaneously\n\n\n    const context = require.context('./images', false, /\\.(png|jpe?g)$/);\n\n    const imageUrls = context.keys().map(context);\n\n    if (imageUrls.length === 0) {\n      return;\n    }\n\n    const requests = imageUrls.map(async src => axios.get(src, {\n      responseType: 'arraybuffer'\n    }));\n    const responses = await Promise.all(requests); // generate array of base64 strings\n\n    const images = responses.map(response => {\n      const raw = arrayBufferToBase64(response.data);\n      return `data:${response.headers['content-type']};base64,${raw}`;\n    }); // cache images\n\n    const now = moment().format('YYYY-MM-DD HH:mm');\n    await localforage.setItem('owner-operator-form-images', {\n      images,\n      cachedAt: now\n    });\n    this.setState({\n      backgroundImages: images\n    });\n  }\n\n  async sendDocumentByEmail(doc) {\n    const formData = new FormData();\n    formData.append('document', doc.output('blob'));\n    formData.append('agreementDate', this.state.agreementDate);\n    formData.append('customerName', this.state.lessorName);\n    formData.append('customerAddress', this.state.lessorAddress);\n    formData.append('customerCity', this.state.lessorCity);\n    formData.append('customerState', this.state.lessorState);\n    formData.append('customerZip', this.state.lessorZip);\n    formData.append('truckVin', this.state.truckVin);\n    formData.append('trailerVin', this.state.trailerVin);\n    formData.append('customerSignature', this.state.lessorMainSignature);\n    await axios.post('/api/form_owner_op', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n  }\n\n}\n\nexport default OwnerOperatorForm;","map":{"version":3,"sources":["/Users/kirill/Documents/Develop/rampart/rampart/frontend/src/components/owner-operator-form/owner-operator-form.js"],"names":["React","Component","MaskedInput","TextField","Button","CircularProgress","axios","localforage","jspdf","SignatureFont","moment","Swal","arrayBufferToBase64","OwnerOperatorForm","constructor","props","onChange","e","setState","target","name","value","state","backgroundImages","loading","agreementDate","lessorName","lessorAddress","lessorCity","lessorState","lessorZip","truckVin","trailerVin","lessorGross","lessorMainSignature","mainCompanyName","mainCompanyAddress","mainCompanyUsdot","mainCompanyEin","mainCompanyMc","componentDidMount","window","scrollTo","setBackgroundImages","onSubmit","doc","generatePdf","sendDocumentByEmail","fire","icon","title","text","msg","response","undefined","status","length","Error","setFontSize","setTextColor","addImage","addPage","addFileToVFS","addFont","setFont","render","maxLength","cache","getItem","cachedAt","diff","images","context","require","imageUrls","keys","map","requests","src","get","responseType","responses","Promise","all","raw","data","headers","now","format","setItem","formData","FormData","append","output","post"],"mappings":"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","sourcesContent":["import React, { Component } from 'react';\nimport MaskedInput from 'react-text-mask';\nimport TextField from '@material-ui/core/TextField';\nimport Button from '@material-ui/core/Button';\nimport CircularProgress from '@material-ui/core/CircularProgress';\nimport 'typeface-roboto';\nimport axios from 'axios';\nimport localforage from 'localforage';\nimport jspdf from 'jspdf';\nimport SignatureFont from '../../assets/fonts/SignatureFont';\nimport moment from 'moment';\nimport Swal from \"sweetalert2\";\nimport './styles.css';\n\nimport {arrayBufferToBase64} from '../../helpers';\n\nclass OwnerOperatorForm extends Component {\n  constructor(props) {\n    super(props);\n\n    this.state = {\n      backgroundImages: [],\n      loading: false,\n      agreementDate: '',\n      lessorName: '',\n      lessorAddress: '',\n      lessorCity: '',\n      lessorState: '',\n      lessorZip: '',\n      truckVin: '',\n      trailerVin: '',\n      lessorGross: '90%',\n      lessorMainSignature: '',\n      mainCompanyName: 'Rampart Transportation INC',\n      mainCompanyAddress: '3029 Wolfe Ct Antelope CA 95843',\n      mainCompanyUsdot: '3411477',\n      mainCompanyEin: '83-3141615',\n      mainCompanyMc: '1100091',\n    };\n  }\n\n  async componentDidMount() {\n    window.scrollTo(0, 0);\n\n    // download and cache background images\n    await this.setBackgroundImages();\n  }\n\n  async onSubmit() {\n    this.setState({loading: true});\n\n    try {\n      const doc = this.generatePdf();\n\n      await this.sendDocumentByEmail(doc);\n\n      await Swal.fire({\n        icon: 'success',\n        title: 'Registered!',\n        text: 'Thank you!'\n      });\n    } catch (e) {\n      let msg = {\n        title: 'Oops... error!',\n        text: 'Something went wrong. Try to submit again ;)'\n      };\n\n      if (e.response !== undefined && e.response.status === 422) {\n        msg = {\n          title: 'Oops... Validation failed!',\n          text: 'Please check the entered data and try again ;)'\n        };\n      }\n\n      await Swal.fire({\n        icon: 'error',\n        title: msg.title,\n        text: msg.text\n      });\n    }\n\n    this.setState({loading: false});\n  }\n\n  generatePdf() {\n    const {\n      backgroundImages,\n      agreementDate,\n      lessorName,\n      lessorAddress,\n      lessorCity,\n      lessorState,\n      lessorZip,\n      truckVin,\n      trailerVin,\n      lessorGross,\n      lessorMainSignature,\n      mainCompanyName,\n      mainCompanyAddress,\n      mainCompanyUsdot,\n      mainCompanyEin,\n      mainCompanyMc\n    } = this.state;\n\n    if (backgroundImages.length === 0) {\n      throw new Error('Failed to build PDF document, background images are missing.');\n    }\n\n    const doc = new jspdf();\n\n    doc.setFontSize(12);\n    doc.setTextColor('black');\n\n    doc.addImage(backgroundImages[0], 'JPEG', 0, 0, 210, 297);\n    doc.text(agreementDate, 55, 50.3);\n    doc.text(mainCompanyName, 95, 50.3);\n    doc.text(mainCompanyAddress, 33, 65.5);\n    doc.text(mainCompanyUsdot, 136.5, 65.5);\n    doc.text(mainCompanyEin, 164, 65.5);\n    doc.text(lessorName, 26, 77);\n    doc.text(lessorAddress, 30, 87.5);\n    doc.text(lessorCity, 23, 97.5);\n    doc.text(lessorState, 92, 97.5);\n    doc.text(lessorZip, 116, 97.5);\n    doc.text(truckVin, 35, 110.5);\n    doc.text(trailerVin, 37, 123.5);\n    doc.text(mainCompanyMc, 89.5, 156);\n    doc.text(mainCompanyName, 16, 286);\n    doc.addPage();\n    doc.addImage(backgroundImages[1], 'JPEG', 0, 0, 210, 297);\n    doc.text(lessorGross, 80, 56);\n    doc.text(mainCompanyName, 16, 286);\n    doc.addPage();\n    doc.addImage(backgroundImages[2], 'JPEG', 0, 0, 210, 297);\n    doc.text(agreementDate, 117, 155);\n    doc.text(mainCompanyName, 30, 217.5);\n    doc.text(lessorName, 26, 238.5);\n    doc.text(agreementDate, 168, 217.5);\n    doc.text(agreementDate, 160, 238.5);\n    doc.addFileToVFS('Meddon.ttf', SignatureFont);\n    doc.addFont('Meddon.ttf', 'Meddon', 'cursive');\n    doc.setFont('Meddon', 'cursive');\n    doc.text(lessorMainSignature, 105, 238.5);\n    doc.setFont('helvetica', 'normal');\n    doc.setFontSize(12);\n    doc.text(mainCompanyName, 16, 286);\n    doc.addPage();\n    doc.addImage(backgroundImages[3], 'JPEG', 0, 0, 210, 297);\n    doc.setFontSize(10);\n    doc.text(mainCompanyName, 97, 49);\n    doc.setFontSize(9);\n    doc.text(mainCompanyName, 28.5, 225.5);\n    doc.addPage();\n    doc.addImage(backgroundImages[4], 'JPEG', 0, 0, 210, 297);\n    doc.setFontSize(12);\n    doc.text(agreementDate, 23, 35);\n    doc.addFileToVFS('Meddon.ttf', SignatureFont);\n    doc.addFont('Meddon.ttf', 'Meddon', 'cursive');\n    doc.setFont('Meddon', 'cursive');\n    doc.text(lessorMainSignature, 85, 35);\n    doc.setFont('helvetica', 'normal');\n    doc.setFontSize(12);\n    doc.text(lessorName, 85, 61);\n\n    return doc;\n  }\n\n  onChange = (e) => this.setState({[e.target.name]: e.target.value});\n\n  render() {\n    return (\n      <div className=\"owner-operator-form\">\n        <div>\n          <span>AGREEMENT made on</span>\n          <span>\n            <MaskedInput\n              mask={value =>\n                value\n                  ? [\n                      /[0-9]/,\n                      /\\d/,\n                      '/',\n                      /\\d/,\n                      /\\d/,\n                      '/',\n                      /\\d/,\n                      /\\d/,\n                      /\\d/,\n                      /\\d/,\n                    ]\n                  : []\n              }\n              id=\"agreement-date\"\n              className=\"agreement-date\"\n              placeholder=\"Date\"\n              guide={true}\n              value={this.state.agreementDate}\n              name=\"agreementDate\"\n              disabled={this.state.loading}\n              onChange={this.onChange}\n            />\n          </span>\n          <span>between Rampart Transportation INC hereinafter referred AND</span>\n        </div>\n        <div className=\"form-field-container\">\n          <TextField\n            label=\"Lessor Name\"\n            id=\"lessor-name\"\n            className=\"lessor-name\"\n            value={this.state.lessorName}\n            name=\"lessorName\"\n            disabled={this.state.loading}\n            onChange={this.onChange}\n          />\n        </div>\n        <div className=\"form-field-container\">\n          <TextField\n            label=\"Address\"\n            id=\"lessor-address\"\n            className=\"lessor-address\"\n            value={this.state.lessorAddress}\n            name=\"lessorAddress\"\n            disabled={this.state.loading}\n            onChange={this.onChange}\n          />\n        </div>\n        <div className=\"form-field-container\">\n          <TextField\n            label=\"City\"\n            id=\"lessor-city\"\n            className=\"lessor-city\"\n            value={this.state.lessorCity}\n            name=\"lessorCity\"\n            disabled={this.state.loading}\n            onChange={this.onChange}\n          />\n          <TextField\n            label=\"State\"\n            id=\"lessor-state\"\n            className=\"lessor-state\"\n            inputProps={{\n              maxLength: 2,\n            }}\n            value={this.state.lessorState}\n            name=\"lessorState\"\n            disabled={this.state.loading}\n            onChange={this.onChange}\n          />\n          <TextField\n            label=\"Zip\"\n            id=\"lessor-zip\"\n            className=\"lessor-zip\"\n            value={this.state.lessorZip}\n            name=\"lessorZip\"\n            disabled={this.state.loading}\n            onChange={this.onChange}\n          />\n        </div>\n        <div className=\"form-field-container\">\n          <TextField\n            label=\"Truck Vin#\"\n            id=\"truck-vin\"\n            className=\"truck-vin\"\n            value={this.state.truckVin}\n            name=\"truckVin\"\n            disabled={this.state.loading}\n            onChange={this.onChange}\n          />\n        </div>\n        <div>\n          <TextField\n            label=\"Trailer Vin#\"\n            id=\"trailer-vin\"\n            className=\"trailer-vin\"\n            value={this.state.trailerVin}\n            name=\"trailerVin\"\n            onChange={this.onChange}\n          />\n        </div>\n        <div className=\"form-field-container\">\n          <TextField\n            label=\"Signature (Type your First and Last Name)\"\n            id=\"lessor-signature\"\n            className=\"lessor-signature\"\n            value={this.state.lessorMainSignature}\n            name=\"lessorMainSignature\"\n            disabled={this.state.loading}\n            onChange={this.onChange}\n          />\n        </div>\n\n        <div className=\"d-flex justify-content-center mt-5\">\n          {this.state.loading && <CircularProgress />}\n          {!this.state.loading && (\n            <Button\n              variant=\"contained\"\n              color=\"primary\"\n              size=\"large\"\n              onClick={() => this.onSubmit()}\n              disabled={this.state.loading}\n            >\n              Submit Document\n            </Button>\n          )}\n        </div>\n      </div>\n    );\n  }\n\n  async setBackgroundImages() {\n    // try to get images from cache (if cache is not older then 24 hours)\n    const cache = await localforage.getItem('owner-operator-form-images');\n    if (cache !== null) {\n      const cachedAt = moment(cache.cachedAt);\n      if (cachedAt.diff(moment(), 'hours') < 24) {\n        this.setState({backgroundImages: cache.images});\n        return;\n      }\n    }\n\n    // download all images simultaneously\n    const context = require.context('./images', false, /\\.(png|jpe?g)$/);\n    const imageUrls = context.keys().map(context);\n    if (imageUrls.length === 0) {\n      return;\n    }\n\n    const requests = imageUrls.map(async src => axios.get(src, {responseType: 'arraybuffer'}));\n    const responses = await Promise.all(requests);\n\n    // generate array of base64 strings\n    const images = responses.map(response => {\n      const raw = arrayBufferToBase64(response.data);\n\n      return `data:${response.headers['content-type']};base64,${raw}`;\n    });\n\n    // cache images\n    const now = moment().format('YYYY-MM-DD HH:mm');\n    await localforage.setItem('owner-operator-form-images', {images, cachedAt: now});\n\n    this.setState({backgroundImages: images});\n  }\n\n  async sendDocumentByEmail(doc) {\n    const formData = new FormData();\n    formData.append('document', doc.output('blob'));\n    formData.append('agreementDate', this.state.agreementDate);\n    formData.append('customerName', this.state.lessorName);\n    formData.append('customerAddress', this.state.lessorAddress);\n    formData.append('customerCity', this.state.lessorCity);\n    formData.append('customerState', this.state.lessorState);\n    formData.append('customerZip', this.state.lessorZip);\n    formData.append('truckVin', this.state.truckVin);\n    formData.append('trailerVin', this.state.trailerVin);\n    formData.append('customerSignature', this.state.lessorMainSignature);\n\n    await axios.post('/api/form_owner_op', formData, {\n      headers: {\n        'Content-Type': 'multipart/form-data'\n      }\n    });\n  }\n}\n\nexport default OwnerOperatorForm;\n"]},"metadata":{},"sourceType":"module"}